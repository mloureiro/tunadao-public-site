---
import Layout from '@layouts/Layout.astro';
import Button from '@components/Button.astro';
import SocialLinks from '@components/SocialLinks.astro';
import { t } from '@i18n/index';

const contactInfo = {
  email: 'tunadao@gmail.com',
  phone: '+351 928 155 399',
  address: 'Campus Politécnico de Viseu, 3504-510 Viseu',
};
---

<Layout
  title={`${t('contact.title')} | Tunadão 1998`}
  description="Entra em contacto com a Tunadão 1998. Envia-nos uma mensagem para marcares atuações, pedidos de informação ou qualquer outro assunto."
>
  <!-- Hero Section -->
  <section class="hero">
    <div class="container">
      <h1 class="hero__title">{t('contact.title')}</h1>
      <p class="hero__subtitle">{t('contact.subtitle')}</p>
    </div>
  </section>

  <!-- Contact Section -->
  <section class="contact">
    <div class="container">
      <div class="contact__grid">
        <!-- Contact Form -->
        <div class="contact__form-container">
          <form class="contact-form" id="contactForm">
            <!-- Honeypot field for spam protection -->
            <input type="text" name="website" class="honeypot" tabindex="-1" autocomplete="off" />

            <div class="form-group">
              <label for="name">{t('contact.form.name')} *</label>
              <input
                type="text"
                id="name"
                name="name"
                required
                placeholder="O teu nome"
              />
            </div>

            <div class="form-group">
              <label for="email">{t('contact.form.email')} *</label>
              <input
                type="email"
                id="email"
                name="email"
                required
                placeholder="email@exemplo.com"
              />
            </div>

            <div class="form-group">
              <label for="subject">{t('contact.form.subject')} *</label>
              <select id="subject" name="subject" required>
                <option value="">Seleciona um assunto</option>
                <option value="atuacao">Pedido de Atuação</option>
                <option value="citadao">CITADÃO - Festival</option>
                <option value="informacao">Pedido de Informação</option>
                <option value="recrutamento">Quero ser Tuno</option>
                <option value="outro">Outro Assunto</option>
              </select>
            </div>

            <div class="form-group">
              <label for="message">{t('contact.form.message')} *</label>
              <textarea
                id="message"
                name="message"
                rows="5"
                required
                placeholder="Escreve a tua mensagem..."
              ></textarea>
            </div>

            <div class="form-actions">
              <Button type="submit" variant="primary" size="lg">
                {t('contact.form.submit')}
              </Button>
            </div>

            <div class="form-status" id="formStatus"></div>
          </form>
        </div>

        <!-- Contact Info -->
        <div class="contact__info">
          <div class="info-card">
            <h2>{t('contact.info.title')}</h2>

            <div class="info-item">
              <div class="info-item__icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                  <polyline points="22,6 12,13 2,6"></polyline>
                </svg>
              </div>
              <div class="info-item__content">
                <span class="info-item__label">{t('contact.info.email')}</span>
                <a href={`mailto:${contactInfo.email}`} class="info-item__value">
                  {contactInfo.email}
                </a>
              </div>
            </div>

            <div class="info-item">
              <div class="info-item__icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                </svg>
              </div>
              <div class="info-item__content">
                <span class="info-item__label">{t('contact.info.phone')}</span>
                <a href={`tel:${contactInfo.phone.replace(/\s/g, '')}`} class="info-item__value">
                  {contactInfo.phone}
                </a>
              </div>
            </div>

            <div class="info-item">
              <div class="info-item__icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                  <circle cx="12" cy="10" r="3"></circle>
                </svg>
              </div>
              <div class="info-item__content">
                <span class="info-item__label">{t('contact.info.address')}</span>
                <span class="info-item__value">{contactInfo.address}</span>
              </div>
            </div>

            <div class="info-social">
              <h3>{t('contact.social')}</h3>
              <SocialLinks />
            </div>
          </div>

          <!-- Map placeholder -->
          <div class="map-container">
            <div class="map-placeholder">
              <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon>
                <line x1="8" y1="2" x2="8" y2="18"></line>
                <line x1="16" y1="6" x2="16" y2="22"></line>
              </svg>
              <p>Campus Politécnico de Viseu</p>
              <a
                href={`https://maps.google.com/?q=${encodeURIComponent(contactInfo.address)}`}
                target="_blank"
                rel="noopener noreferrer"
                class="map-link"
              >
                Ver no Google Maps →
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</Layout>

<style>
  /* Hero Section */
  .hero {
    background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
    color: var(--color-text-inverted);
    padding: var(--space-12) 0;
    text-align: center;
  }

  .hero__title {
    font-size: var(--text-4xl);
    font-weight: 700;
    margin-bottom: var(--space-2);
  }

  .hero__subtitle {
    font-size: var(--text-xl);
    opacity: 0.9;
  }

  /* Contact Section */
  .contact {
    padding: var(--space-12) 0;
    background-color: var(--color-background);
  }

  .contact__grid {
    display: grid;
    gap: var(--space-8);
    grid-template-columns: 1fr;
  }

  @media (min-width: 1024px) {
    .contact__grid {
      grid-template-columns: 1fr 400px;
    }
  }

  /* Contact Form */
  .contact__form-container {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    padding: var(--space-6);
  }

  .honeypot {
    position: absolute;
    left: -9999px;
    top: -9999px;
  }

  .form-group {
    margin-bottom: var(--space-4);
  }

  .form-group label {
    display: block;
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--color-text);
    margin-bottom: var(--space-2);
  }

  .form-group input,
  .form-group select,
  .form-group textarea {
    width: 100%;
    padding: var(--space-3);
    font-size: var(--text-base);
    color: var(--color-text);
    background-color: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
  }

  .form-group input:focus,
  .form-group select:focus,
  .form-group textarea:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(41, 22, 111, 0.1);
  }

  .form-group textarea {
    resize: vertical;
    min-height: 120px;
  }

  .form-actions {
    margin-top: var(--space-6);
  }

  .form-status {
    margin-top: var(--space-4);
    padding: var(--space-3);
    border-radius: var(--radius-md);
    text-align: center;
    display: none;
  }

  .form-status.success {
    display: block;
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  }

  .form-status.error {
    display: block;
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  }

  /* Contact Info */
  .contact__info {
    display: flex;
    flex-direction: column;
    gap: var(--space-6);
  }

  .info-card {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    padding: var(--space-6);
  }

  .info-card h2 {
    font-size: var(--text-xl);
    font-weight: 700;
    color: var(--color-text);
    margin-bottom: var(--space-6);
  }

  .info-item {
    display: flex;
    gap: var(--space-4);
    margin-bottom: var(--space-4);
  }

  .info-item:last-of-type {
    margin-bottom: 0;
  }

  .info-item__icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
    border-radius: var(--radius-md);
    color: var(--color-text-inverted);
    flex-shrink: 0;
  }

  .info-item__content {
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .info-item__label {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
  }

  .info-item__value {
    font-size: var(--text-base);
    color: var(--color-text);
    text-decoration: none;
  }

  a.info-item__value:hover {
    color: var(--color-primary);
  }

  .info-social {
    margin-top: var(--space-6);
    padding-top: var(--space-6);
    border-top: 1px solid var(--color-border);
  }

  .info-social h3 {
    font-size: var(--text-base);
    font-weight: 600;
    color: var(--color-text);
    margin-bottom: var(--space-3);
  }

  /* Map */
  .map-container {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    overflow: hidden;
  }

  .map-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--space-8);
    background: linear-gradient(135deg, var(--color-background) 0%, var(--color-surface) 100%);
    text-align: center;
    min-height: 200px;
  }

  .map-placeholder svg {
    color: var(--color-primary);
    margin-bottom: var(--space-3);
  }

  .map-placeholder p {
    font-size: var(--text-base);
    color: var(--color-text);
    margin-bottom: var(--space-3);
  }

  .map-link {
    font-size: var(--text-sm);
    color: var(--color-primary);
    text-decoration: none;
    font-weight: 500;
  }

  .map-link:hover {
    text-decoration: underline;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('contactForm') as HTMLFormElement;
    const formStatus = document.getElementById('formStatus');

    if (form && formStatus) {
      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const formData = new FormData(form);

        // Check honeypot
        if (formData.get('website')) {
          return;
        }

        const submitButton = form.querySelector('button[type="submit"]');
        if (submitButton) {
          submitButton.textContent = 'A enviar...';
          (submitButton as HTMLButtonElement).disabled = true;
        }

        try {
          // In production, this would send to the CMS API
          // For now, simulate a successful submission
          await new Promise(resolve => setTimeout(resolve, 1000));

          formStatus.textContent = 'Mensagem enviada com sucesso! Entraremos em contacto brevemente.';
          formStatus.className = 'form-status success';
          form.reset();
        } catch (error) {
          formStatus.textContent = 'Erro ao enviar mensagem. Por favor, tente novamente.';
          formStatus.className = 'form-status error';
        } finally {
          if (submitButton) {
            submitButton.textContent = 'Enviar mensagem';
            (submitButton as HTMLButtonElement).disabled = false;
          }
        }
      });
    }
  });
</script>
